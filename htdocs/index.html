<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>MetaPlayer - Demo Version</title>
        <link rel="stylesheet" type="text/css" href="css/themes/default/easyui.css">
        <link rel="stylesheet" type="text/css" href="css/themes/icon.css">
        <link rel="stylesheet" type="text/css" href="css/mp.css">
        <script type="text/javascript" src="js/jquery-1.6.2.js"></script>
        <script type="text/javascript" src="js/easyloader.js"></script>
        <script type="text/javascript" src="js/jquery.json-2.3.js"></script>
        <script type="text/javascript" src="js/model.js"></script>
        <script type="text/javascript" src="js/utils.js"></script>
        <script type="text/javascript" src="js/repository.js"></script>
        <script type="text/javascript">
            easyloader.load('treegrid', function(){
                $('#metaTree').treegrid({
                    title:'MetaTree',
                    iconCls:'icon-save',
                    width: 365,
                    height:400,
                    nowrap: true,
                    rownumbers: false,
                    animate:true,
                    collapsible:true,
                    url: null, // 'treegrid_data.json', 
                    idField: 'id',
                    treeField: 'name',
                    frozenColumns:[[
                            {
                                field:'name',
                                title:'Название',
                                width:250,
                                formatter:function(value, node){
                                    return '<input type="checkbox" id="mt_checkbox_' + node.getId() + '" /><label for="mt_checkbox_' + node.getId() + '">' + value + '</label>';
                                }
                            }
                        ]],
                    columns:[[
                            //{checkbox: true, field: 'test_c'},
                            {field:'duration',title:'Длит.',width:30},
                            {field:'date',title:'Дата',width:80}
                        ]],
                    onBeforeLoad:function(row, node){
                        console.log("before load, row " + $.toJSON(row));
                        if (row === null) {
                            new BandRepository().list(function (resultData) {
                                $('#metaTree').treegrid('loadData', resultData);
                            });
                        } else {
                            $('#metaTree').treegrid('collapse', row.getId());
                            row.loadChildren(function (resultData) {
                                $('#metaTree').treegrid('append', {parent: row.getId(), data: resultData});
                                $('#metaTree').treegrid('expand', row.getId());
                            });
                        }
                        return false;
                    },
                    onLoadSuccess: function(row, data) {
                        console.log('data loaded ' + $.toJSON(data));
                    },
                    onContextMenu: function(e,row){
                        e.preventDefault();
                        $(this).treegrid('unselectAll');
                        $(this).treegrid('select', row.code);
                        $('#mm').menu('show', {
                            left: e.pageX,
                            top: e.pageY
                        });
                    }
                });
            });
        </script>
    </head>
    <body>
        <div id="mainHeader">
        </div>
        <div id="mainBody">
            <div id="bodyTree" style="float: left;">
                <table id="metaTree"></table>

                <div id="mm" class="easyui-menu" style="width:120px;">
                    <div onclick="play()">Play</div>
                </div>
            </div>
            
            <div id="bodyPlayer"  style="float: left;">
                Player
            </div>
        </div>
        <div id="mainFooter" style="float: left; width: 800px;">
            тут благодарности
        </div>
    </body>
</html>